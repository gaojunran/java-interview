---
title: 022 MySQL 三层 B+ 树能存多少数据？
---

MySQL 的 InnoDB 存储引擎使用 **B+ 树**（**不是 B 树**）作为其索引结构。要估算 **三层 B+ 树** 能存储多少数据，我们需要分析 B+ 树的结构，并计算它在不同层级所能容纳的索引数量。

---

## 一、B+ 树结构回顾

B+ 树的特点：

* 所有数据都存在**叶子节点**；
* 非叶子节点（即中间节点）只存储**索引（key）和指针**；
* 叶子节点之间是**双向链表**，方便范围扫描；
* 每个节点的大小通常是 **一个数据页大小（默认 16KB）**。

---

## 二、假设条件（典型 MySQL 场景）

为了估算三层 B+ 树能存储多少数据，假设如下：

* 每个数据页大小为 **16KB = 16 \* 1024 = 16384 字节**
* 每个索引键（主键）为 **8 字节（BIGINT）**
* 每个指针占 **6 字节**（InnoDB 中的指针并不是裸地址，而是页号 + 偏移量）
* 每个数据行在叶子节点大约占 **100 字节**（保守估计）

---

## 三、每个节点能存储多少项？

### 1. 非叶子节点（中间节点）

每个项 = key + 指针 = 8 + 6 = 14 字节

节点总大小 = 16384 字节

能容纳的项数 ≈ `16384 / 14 ≈ 1170 项`

### 2. 叶子节点

每项大小 ≈ 一条完整记录（包含主键和所有列）

假设每行记录为 100 字节，

能容纳的记录数 ≈ `16384 / 100 ≈ 163 条`

---

## 四、三层 B+ 树结构

三层结构如下：

```
Level 0 (根节点):         1 个页（指向 Level 1 的页）
Level 1（中间节点）:     每页 1170 个指针，指向 Level 2（叶子节点）
Level 2（叶子节点）:     每页约存 163 行数据
```

计算总能容纳的数据行数：

* 根节点可容纳 ≈ 1170 个一级节点
* 每个一级节点可容纳 ≈ 1170 个叶子节点
* 每个叶子节点可容纳 ≈ 163 条数据

所以：

```
总行数 ≈ 1170（根） * 1170（中间） * 163（叶子）
      ≈ 223 万个叶子节点 * 163
      ≈ 363,413,100 条数据（约 3.6 亿行）
```

---

## 五、总结

在一个典型设置（16KB 页、8 字节主键、100 字节数据行）下：

> **一个三层 B+ 树结构大约可以容纳 3.6 亿条数据记录。**

一旦超过这个数量，B+ 树的高度将从 3 层增长为 4 层。但注意：

* 实际容量与行数据大小、索引字段大小密切相关；
* 包含二级索引时，二级索引结构与主键也有关；
* 大表在实践中可能因为碎片、页分裂等问题影响结构紧凑度。

---

说明：这个答案的假设为数据行 100 字节，相比网上普遍的答案（假设数据行 1 KB）更合理。

继续提问：https://chatgpt.com/share/686ddaae-c7b0-8010-b744-83100251f17f
